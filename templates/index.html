<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Score Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-image: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('https://www.vancopayments.com/hs-fs/hubfs/Graduation%20-%20Cap%20throw.png?width=2460&height=1386&name=Graduation%20-%20Cap%20throw.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
        }
        .navbar { background-color: #1a202c; }
        .navbar a { color: white; }
        .section { padding: 2rem; }
        .form-container { max-width: 600px; margin: auto; }
        .result-container { margin-top: 1rem; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <nav class="navbar p-4">
        <div class="container mx-auto flex justify-between">
            <div class="text-xl font-bold">Score Calculator</div>
            <div>
                <a href="#home" class="px-4">Home</a>
                <a href="#about" class="px-4">About</a>
                <a href="#contact" class="px-4">Contact</a>
            </div>
        </div>
    </nav>

    <section id="home" class="section bg-white">
        <div class="container mx-auto">
            <h1 class="text-2xl font-bold mb-4">Engineering Admission Score Calculator 2023</h1>
            <div class="form-container">
                <label for="year-select" class="block mb-2">Select Year</label>
                <select id="year-select" class="border p-2 w-full mb-4">
                    <option value="first">First Year</option>
                    <option value="second">Second Year</option>
                </select>

                <div id="first-year-form" class="form-group">
                    <h2 class="text-xl mb-2">First Year Inputs</h2>
                    <input type="number" id="mg" class="border p-2 w-full mb-2" placeholder="General Average (mg)" step="0.01">
                    <input type="number" id="rank1" class="border p-2 w-full mb-2" placeholder="Rank 1" min="1">
                    <input type="number" id="effectif1" class="border p-2 w-full mb-2" placeholder="Effectif 1" min="1">
                    <input type="number" id="rank2" class="border p-2 w-full mb-2" placeholder="Rank 2" min="1">
                    <input type="number" id="effectif2" class="border p-2 w-full mb-2" placeholder="Effectif 2" min="1">
                    <input type="number" id="birthYear" class="border p-2 w-full mb-2" placeholder="Birth Year" min="1900" max="2025">
                    <input type="number" id="bacScore" class="border p-2 w-full mb-2" placeholder="Bac Score" step="0.01">
                    <input type="number" id="french1" class="border p-2 w-full mb-2" placeholder="French 1" step="0.01">
                    <input type="number" id="french2" class="border p-2 w-full mb-2" placeholder="French 2" step="0.01">
                    <input type="number" id="english1" class="border p-2 w-full mb-2" placeholder="English 1" step="0.01">
                    <input type="number" id="english2" class="border p-2 w-full mb-2" placeholder="English 2" step="0.01">
                    <input type="number" id="math1" class="border p-2 w-full mb-2" placeholder="Math 1" step="0.01">
                    <input type="number" id="math2" class="border p-2 w-full mb-2" placeholder="Math 2" step="0.01">
                    <input type="number" id="physics1" class="border p-2 w-full mb-2" placeholder="Physics 1" step="0.01">
                    <input type="number" id="physics2" class="border p-2 w-full mb-2" placeholder="Physics 2" step="0.01">
                    <input type="number" id="cs1" class="border p-2 w-full mb-2" placeholder="CS 1" step="0.01">
                    <input type="number" id="cs2" class="border p-2 w-full mb-2" placeholder="CS 2" step="0.01">
                </div>

                <div id="second-year-form" class="form-group hidden">
                    <h2 class="text-xl mb-2">Second Year Inputs</h2>
                    <input type="number" id="l1" class="border p-2 w-full mb-2" placeholder="L1 Score" step="0.01">
                    <input type="number" id="l2" class="border p-2 w-full mb-2" placeholder="L2 Score" step="0.01">
                    <input type="number" id="l3" class="border p-2 w-full mb-2" placeholder="L3 Score" step="0.01">
                    <input type="number" id="m1" class="border p-2 w-full mb-2" placeholder="M1 Score" step="0.01">
                    <input type="number" id="birthYear2" class="border p-2 w-full mb-2" placeholder="Birth Year" min="1900" max="2025">
                    <input type="number" id="bacScore2" class="border p-2 w-full mb-2" placeholder="Bac Score" step="0.01">
                    <label class="flex items-center mb-2">
                        <input type="checkbox" id="redoublant" class="mr-2"> Redoublant
                    </label>
                </div>

                <button onclick="calculateScore()" class="bg-blue-500 text-white p-2 rounded w-full">Calculate Score</button>

                <div id="results" class="result-container hidden">
                    <h2 class="text-xl mb-2">Results</h2>
                    <div id="score-results"></div>
                    <h3 class="text-lg mt-4 mb-2">Orientation Suggestions</h3>
                    <ul id="suggestions" class="list-disc pl-5"></ul>
                </div>
            </div>

            <div class="mt-8">
                <h2 class="text-xl mb-2">Resources</h2>
                <ul class="list-disc pl-5">
                    <li><a href="#" class="text-blue-500">بلاغ المناظرات الخصوصية 2024</a></li>
                    <li><a href="#" class="text-blue-500">ملحق المناظرات الخصوصية - سنة أولى دورة سنة 2024</a></li>
                    <li><a href="#" class="text-blue-500">Critères de Sélection des Candidats aux Concours Spécifiques 2024</a></li>
                </ul>
            </div>
        </div>
    </section>

    <section id="about" class="section bg-gray-50">
        <div class="container mx-auto">
            <h2 class="text-xl font-bold mb-4">About</h2>
            <p>This tool calculates admission scores for Tunisian engineering schools based on 2023-2024 criteria, providing orientation suggestions and official resources.</p>
        </div>
    </section>

    <section id="contact" class="section bg-white">
        <div class="container mx-auto">
            <h2 class="text-xl font-bold mb-4">Contact</h2>
            <p>For inquiries, contact the administration via <a href="mailto:csingenieur.inscription.tn" class="text-blue-500">csingenieur.inscription.tn</a>.</p>
        </div>
    </section>

    <script>
        const ORIENTATION_THRESHOLDS = {
            'ENIT': { min_score: 85, avg_score: 90 },
            'ENSI': { min_score: 80, avg_score: 88 },
            'INSAT': { min_score: 78, avg_score: 85 }
        };

        function calculateScoreA(data) {
            try {
                const mg = parseFloat(data.mg || 0);
                const rank1 = parseInt(data.rank1 || 1);
                const effectif1 = parseInt(data.effectif1 || 1);
                const rank2 = parseInt(data.rank2 || 1);
                const effectif2 = parseInt(data.effectif2 || 1);
                const birthYear = parseInt(data.birthYear || 2000);
                const bacScore = parseFloat(data.bacScore || 0);
                const french1 = parseFloat(data.french1 || 0);
                const french2 = parseFloat(data.french2 || 0);
                const english1 = parseFloat(data.english1 || 0);
                const english2 = parseFloat(data.english2 || 0);
                const math1 = parseFloat(data.math1 || 0);
                const math2 = parseFloat(data.math2 || 0);
                const physics1 = parseFloat(data.physics1 || 0);
                const physics2 = parseFloat(data.physics2 || 0);
                const cs1 = parseFloat(data.cs1 || 0);
                const cs2 = parseFloat(data.cs2 || 0);

                let M = 0;
                if (mg >= 15) M = 100;
                else if (mg > 10 && mg < 15) M = 20 * (mg - 10);

                const ri1 = (rank1 - 1) / effectif1;
                const ri2 = (rank2 - 1) / effectif2;
                const Ri1 = ri1 <= 0.3 ? 100 - (700 * ri1) / 3 : 0;
                const Ri2 = ri2 <= 0.3 ? 100 - (700 * ri2) / 3 : 0;
                const R = (Ri1 + Ri2) / 2;

                const B1 = birthYear >= 2023 - 22 ? 5 : 0;

                let B2 = 0;
                if (bacScore >= 16) B2 = 20;
                else if (bacScore >= 14) B2 = 15;
                else if (bacScore >= 12) B2 = 10;
                else if (bacScore >= 11) B2 = 5;

                const ML = (french1 + french2 + english1 + english2) / 4;

                const score_e = ((math1 + math2) * 0.4 + (physics1 + physics2) * 0.3 + (cs1 + cs2) * 0.3) / 2 * 5;

                const score_a = 0.2 * M + (1.4 / 3) * R + (5 / 6) * ML + (2 / 3) * (B1 + B2);
                const globalScore = score_a * 0.7 + score_e * 0.3;

                const suggestions = Object.entries(ORIENTATION_THRESHOLDS).map(([school, thresholds]) => {
                    const status = globalScore >= thresholds.avg_score ? 'Strong' : globalScore >= thresholds.min_score ? 'Moderate' : 'Low';
                    return `${school}: ${status} chance (Min: ${thresholds.min_score}, Avg: ${thresholds.avg_score})`;
                });

                return {
                    scoreA: score_a.toFixed(2),
                    scoreE: score_e.toFixed(2),
                    globalScore: globalScore.toFixed(2),
                    scoreEComponents: {
                        math: ((math1 + math2) / 2).toFixed(2),
                        physics: ((physics1 + physics2) / 2).toFixed(2),
                        cs: ((cs1 + cs2) / 2).toFixed(2)
                    },
                    suggestions
                };
            } catch (e) {
                return { error: 'Invalid input data' };
            }
        }

        function calculateScoreSecondYear(data) {
            try {
                const l1 = parseFloat(data.l1 || 0);
                const l2 = parseFloat(data.l2 || 0);
                const l3 = parseFloat(data.l3 || 0);
                const m1 = parseFloat(data.m1 || 0);
                const birthYear = parseInt(data.birthYear2 || 2000);
                const bacScore = parseFloat(data.bacScore2 || 0);
                const redoublant = data.redoublant || false;

                const mg = (l1 + l2 + l3 + m1) / 4;
                let M = 0;
                if (mg >= 15) M = 100;
                else if (mg > 10 && mg < 15) M = 20 * (mg - 10);

                const B1 = birthYear >= 2023 - 24 ? 5 : 0;

                let B2 = 0;
                if (bacScore >= 16) B2 = 20;
                else if (bacScore >= 14) B2 = 15;
                else if (bacScore >= 12) B2 = 10;
                else if (bacScore >= 11) B2 = 5;

                const C = redoublant ? 0.8 : 1;

                const score = C * (M + B1 + B2);

                const suggestions = Object.entries(ORIENTATION_THRESHOLDS).map(([school, thresholds]) => {
                    const status = score >= thresholds.avg_score ? 'Strong' : score >= thresholds.min_score ? 'Moderate' : 'Low';
                    return `${school}: ${status} chance (Min: ${thresholds.min_score}, Avg: ${thresholds.avg_score})`;
                });

                return { score: score.toFixed(2), suggestions };
            } catch (e) {
                return { error: 'Invalid input data' };
            }
        }

        function calculateScore() {
            const year = document.getElementById('year-select').value;
            const resultsDiv = document.getElementById('results');
            const scoreResults = document.getElementById('score-results');
            const suggestionsList = document.getElementById('suggestions');

            if (year === 'first') {
                const data = {
                    mg: document.getElementById('mg').value,
                    rank1: document.getElementById('rank1').value,
                    effectif1: document.getElementById('effectif1').value,
                    rank2: document.getElementById('rank2').value,
                    effectif2: document.getElementById('effectif2').value,
                    birthYear: document.getElementById('birthYear').value,
                    bacScore: document.getElementById('bacScore').value,
                    french1: document.getElementById('french1').value,
                    french2: document.getElementById('french2').value,
                    english1: document.getElementById('english1').value,
                    english2: document.getElementById('english2').value,
                    math1: document.getElementById('math1').value,
                    math2: document.getElementById('math2').value,
                    physics1: document.getElementById('physics1').value,
                    physics2: document.getElementById('physics2').value,
                    cs1: document.getElementById('cs1').value,
                    cs2: document.getElementById('cs2').value
                };
                const result = calculateScoreA(data);
                if (result.error) {
                    scoreResults.innerHTML = `<p class="text-red-500">${result.error}</p>`;
                } else {
                    scoreResults.innerHTML = `
                        <p>Score A: ${result.scoreA}</p>
                        <p>Score E: ${result.scoreE}</p>
                        <p>Global Score: ${result.globalScore}</p>
                        <p>Math Average: ${result.scoreEComponents.math}</p>
                        <p>Physics Average: ${result.scoreEComponents.physics}</p>
                        <p>CS Average: ${result.scoreEComponents.cs}</p>
                    `;
                    suggestionsList.innerHTML = result.suggestions.map(s => `<li>${s}</li>`).join('');
                }
            } else {
                const data = {
                    l1: document.getElementById('l1').value,
                    l2: document.getElementById('l2').value,
                    l3: document.getElementById('l3').value,
                    m1: document.getElementById('m1').value,
                    birthYear2: document.getElementById('birthYear2').value,
                    bacScore2: document.getElementById('bacScore2').value,
                    redoublant: document.getElementById('redoublant').checked
                };
                const result = calculateScoreSecondYear(data);
                if (result.error) {
                    scoreResults.innerHTML = `<p class="text-red-500">${result.error}</p>`;
                } else {
                    scoreResults.innerHTML = `<p>Score: ${result.score}</p>`;
                    suggestionsList.innerHTML = result.suggestions.map(s => `<li>${s}</li>`).join('');
                }
            }
            resultsDiv.classList.remove('hidden');
        }

        document.getElementById('year-select').addEventListener('change', function() {
            const firstYearForm = document.getElementById('first-year-form');
            const secondYearForm = document.getElementById('second-year-form');
            if (this.value === 'first') {
                firstYearForm.classList.remove('hidden');
                secondYearForm.classList.add('hidden');
            } else {
                firstYearForm.classList.add('hidden');
                secondYearForm.classList.remove('hidden');
            }
            document.getElementById('results').classList.add('hidden');
        });
    </script>
</body>
</html>
